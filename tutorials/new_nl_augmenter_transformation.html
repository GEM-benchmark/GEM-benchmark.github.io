<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="description" content="Benchmark natural language generation systems with GEM."/><meta property="og:image" content="https://og-image.now.sh/**GEM**%20Benchmark.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fvercel-triangle-black.svg"/><meta name="og:title" content="GEM"/><meta name="twitter:card" content="summary_large_image"/><title>GEM Using and Adding Transformation to NL-Augmenter</title><link rel="preload" href="/_next/static/css/2786522978a02f025205.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2786522978a02f025205.css" data-n-g=""/><link rel="preload" href="/_next/static/css/f2fce7b83fe6ca04479b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f2fce7b83fe6ca04479b.css" data-n-p=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/_next/static/chunks/main-47bc8f80085b54a800da.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.baa41d4dbf5d52db897c.js" as="script"/><link rel="preload" href="/_next/static/chunks/76fa31df43514ea5aaf6b0525de03ac0f65eec9e.4a36a385313236c59b19.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-a9ae7a6d1de4e51a7ab6.js" as="script"/><link rel="preload" href="/_next/static/chunks/cb1608f2.c3a9f0eb95374ca4919a.js" as="script"/><link rel="preload" href="/_next/static/chunks/3a03639cec9cbb3837db9d33dd6cd155d0d21f09.13fa0eac69555f2fe80c.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/tutorials/%5Bid%5D-766b6427396d14dc91ae.js" as="script"/></head><body><div id="__next"><div class="layout_background__1AVEa undefined"><header class="layout_header__2rhWq"><div class="navbar_navwrapper__15zia"><div class="navbar_gradbar__1Xi5u"></div><nav class="navbar_navbar__3gnco"><span class="utils_headingLg__de7p0 navbar_navbarlogo__PLEwr"><a href="/">GEM BENCHMARK</a></span><div class="navbar_menutoggle__358pJ" id="mobile-menu"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars fa-w-14 navbar_bar__QVPSR" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg></div><ul><li class="navbar_navitem__3ICSG navbar_pushright__3G2DM"><a href="/resources">Resources</a></li><li class="navbar_navitem__3ICSG"><a href="/data_cards">Data Cards</a></li><li class="navbar_navitem__3ICSG"><a href="/model_cards">Model Cards</a></li><li class="navbar_navitem__3ICSG"><a href="/tutorials">tutorials</a></li><li class="navbar_navitem__3ICSG"><a href="/results">Results</a></li><li class="navbar_navitem__3ICSG"><a href="/papers">Papers</a></li><li class="navbar_navitem__3ICSG"><a href="/team">Team</a></li><li class="navbar_navitem__3ICSG"><a href="/nl_augmenter">NL-Augmenter</a></li><li class="navbar_navitem__3ICSG"><a href="/hackathon">Hackathon</a></li></ul></nav></div></header><div class="layout_container__2t4v2"><main><article><span class="utils_headingXl__1XecN">Using and Adding Transformation to NL-Augmenter</span><span class="utils_smallSpace__375iy"></span><span class="utils_lightText__12Ckm">Transformation</span><div><p>This tutorial will demonstrate how to add a new transformation process to the NL-Augmenter library, which researchers can then use to generate new augmented datasets.
We will not cover using filters in this tutorial. If you are interested in using filters, check out the tutorial <a href="https://github.com/GEM-benchmark/GEM-benchmark.github.io/blob/main/web/data/notebooks/GEM_Hackathon_2021_filters_tutorial.ipynb">here</a>.</p>
<h2 id="using-transformations">Using transformations</h2>
<p>A transformation is represented as a python class.
To use a transformation, instantiate an instance of the transformation class and call it via <code>transformation.generate</code>.
See the code snippet below for an example.
Note that most transformations have unique parameters and <code>generate</code> signatures.
Please refer to the README and code of the specific transformation you're interested in using for details.
You can find a full list of transformations <a href="https://github.com/GEM-benchmark/NL-Augmenter/tree/main/transformations">here</a>.</p>
<pre><code class="hljs language-python"><span class="hljs-keyword">from</span> transformations.butter_fingers_perturbation <span class="hljs-keyword">import</span> ButterFingersPerturbation
transform = ButterFingersPerturbation(prob=<span class="hljs-number">0.2</span>)
corpus = [<span class="hljs-string">'This is the first sentence.'</span>, <span class="hljs-string">'This is the second sentence.'</span>]
<span class="hljs-comment"># transformations return a list </span>
transformed_corpus = [transform.generate(sentence)[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> sentence <span class="hljs-keyword">in</span> corpus]</code></pre>
<p>Currently, transformations <em>do not</em> support batch mode, so you will need to pass your sentences into <code>transform.generate</code> individually.
After transforming your corpus, save your data in the preferred format (ideally <code>json</code> or <code>jsonlines</code>).
Then follow <a href="https://gem-benchmark.com/tutorials/new_data_loader">this tutorial</a> to add your dataset to GEM.</p>
<h2 id="adding-transformations">Adding transformations</h2>
<h3 id="preliminaries">Preliminaries</h3>
<h4 id="check-for-novelty">Check for novelty</h4>
<p>First step, and probably the most important one, is to carefully read through the <a href="https://github.com/GEM-benchmark/NL-Augmenter/tree/main/transformations">list of existing transformations</a>, making sure that no one has already covered the ground you’re proposing. There are dozens of existing systems and many more that are under review, so why duplicate existing work?</p>
<p>Make sure to check the <strong>transformations</strong> subdirectory in the project repo, as well as the <a href="https://github.com/GEM-benchmark/NL-Augmenter/pulls">list of pull requests</a>.</p>
<h4 id="check-the-documentation">Check the documentation</h4>
<p>So, you’re certain that your contribution will be novel. Now, the next step is to go to the project repo and carefully read through the documentation. Most important for our purposes are the <a href="https://github.com/GEM-benchmark/NL-Augmenter/blob/main/README.md">main readme document</a>, plus the readmes for the <a href="https://github.com/GEM-benchmark/NL-Augmenter/blob/main/interfaces/README.md"><strong>interfaces</strong></a> and <a href="https://github.com/GEM-benchmark/NL-Augmenter/blob/main/evaluation/README.md"><strong>evaluation</strong></a> directories.</p>
<p>Reading these will give you a solid understanding of the rest of the steps we’re going to cover.</p>
<h3 id="setup">Setup</h3>
<h4 id="fork-the-project-repo">Fork the project repo</h4>
<p>Once you’re clear on the documentation, go ahead and fork the repository. New transformations should be submitted as pull requests to the main NL-Augmenter repo.</p>
<a href="https://docs.github.com/en/github/getting-started-with-github/fork-a-repo">
<div style="text-align:center"><img src="https://docs.github.com/assets/images/help/repository/fork_button.jpg" alt="fork button" width="500"/></div>
</a>
<p>Clone to your machine, and create a new branch to work in.</p>
<pre><code class="hljs language-bash">git <span class="hljs-built_in">clone</span> <span class="hljs-variable">$PATH_TO_YOUR_FORK</span>
<span class="hljs-built_in">cd</span> NL-Augmenter
git checkout -b new_transformation</code></pre>
<h4 id="copy-an-existing-transformation-as-a-base">Copy an existing transformation as a base</h4>
<p>We’re going to start creating our own transformation by copying an existing simple example.</p>
<pre><code class="hljs language-bash"><span class="hljs-built_in">cd</span> transformations/
cp -r butter_fingers_perturbation new_transformation
<span class="hljs-built_in">cd</span> new_transformation</code></pre>
<h3 id="create-your-transformation">Create your transformation</h3>
<h4 id="update-the-existing-class-info">Update the existing class info</h4>
<p>Open the <code>transformation.py</code> file in your editor of choice. Make sure to rename the class to a name that describes your transformation.</p>
<p>The first thing to define is <a href="https://github.com/GEM-benchmark/NL-Augmenter/blob/main/interfaces/README.md">what kind of interface</a> our transformation is going to implement, which tells us what it should accept as input and return as output. As an example, we could choose to implement the QuestionAnswerOperation, which expects a question as a string, some context as a string, and answers as a list of strings, and returns a transformed version.</p>
<p>For our purposes, we’ll be implementing the SentenceOperation interface, which expects only a single piece of text as input and output.</p>
<pre><code class="hljs language-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KeyphraseInsertion</span>(<span class="hljs-params">SentenceOperation</span>):</span></code></pre>
<p>You’ll also need to decide which downstream tasks you think your class can be applied to: here, we’re going to choose text classification as an example.</p>
<pre><code class="hljs language-python">tasks = [TaskType.TEXT_CLASSIFICATION]</code></pre>
<p>Pick the languages this transformation can accept as input using ISO codes here. We’ll stick with English as a default.</p>
<pre><code class="hljs language-python">languages = [<span class="hljs-string">"en"</span>]</code></pre>
<p>The keywords list is important to fill out. This will give reviewers some idea of the purpose of your transformation, as well as the consequences of using it. You can find a full list and explanation in the <a href="https://github.com/GEM-benchmark/NL-Augmenter/blob/main/docs/keywords.md">docs/keywords.md</a> file. I’m going to leave the existing set as they are.</p>
<pre><code class="hljs language-python">keywords = [<span class="hljs-string">"morphological"</span>, <span class="hljs-string">"noise"</span>, <span class="hljs-string">"rule-based"</span>, <span class="hljs-string">"high-coverage"</span>, <span class="hljs-string">"high-precision"</span>]</code></pre>
<h4 id="override-the-generate-method">Override the generate method</h4>
<p>Now the preliminaries are done, it’s time to create our transformation. We need to override the generate method to carry out our transformation, paying attention to the expected types of the returned values.</p>
<p>Remember, for SentenceOperations, the type of the output is a list of strings, so that’s what we should provide. You’ll see our sample class includes a max outputs parameter that controls the number of new outputs generated from a single input sequence. It’s recommended that you use the same format to control how many texts are returned from your transformation.</p>
<p>In our example class, we’re going to insert a keyphrase between every second element in our string.</p>
<pre><code class="hljs language-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, seed=<span class="hljs-number">0</span>, max_outputs=<span class="hljs-number">1</span>, insert_every=<span class="hljs-number">2</span>, keyphrase=<span class="hljs-string">"kp_test"</span></span>):</span>
    <span class="hljs-built_in">super</span>().__init__(seed, max_outputs=max_outputs)
    self.insert_every = insert_every
    self.keyphrase = keyphrase

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate</span>(<span class="hljs-params">self, sentence: <span class="hljs-built_in">str</span></span>):</span>
    perturbed_texts = []
    itertext = [sentence.split()[i:i + self.insert_every] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span>
                <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(sentence.split()), self.insert_every)]
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.max_outputs):
        new_text = [<span class="hljs-string">f"<span class="hljs-subst">{<span class="hljs-string">' '</span>.join(x)}</span> <span class="hljs-subst">{self.keyphrase}</span>"</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> itertext]
        perturbed_texts.append(<span class="hljs-string">' '</span>.join(new_text))
    <span class="hljs-keyword">return</span> perturbed_texts</code></pre>
<h4 id="add-your-requirements">Add your requirements</h4>
<p>If you’ve added any new package requirements, you’re going to need to add them to a <code>requirements.txt</code> in the same directory as your transformation. This helps to keep each transformations’ imports separate.</p>
<p>For example, lets add sklearn here, just in case.</p>
<pre><code class="hljs language-bash">scikit-learn==1.0.1</code></pre>
<h3 id="test-your-solution">Test your solution</h3>
<p>Now, it’s time to test your solution on some sample data to make sure it works. First, create a test.json file in the same directory as your transformation, and add at least five test cases.</p>
<pre><code class="hljs language-json">{
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"new_transformation"</span>,
  <span class="hljs-attr">"test_cases"</span>: [
    {
      <span class="hljs-attr">"class"</span>: <span class="hljs-string">"KeyphraseInsertion"</span>,
      <span class="hljs-attr">"inputs"</span>: {
        <span class="hljs-attr">"sentence"</span>: <span class="hljs-string">"Andrew finally returned the French book to Chris that I bought last week"</span>
      },
      <span class="hljs-attr">"outputs"</span>: [{
        <span class="hljs-attr">"sentence"</span>: <span class="hljs-string">"Andrew finally kp_test returned the kp_test French book kp_test to Chris kp_test that I kp_test bought last kp_test week kp_test"</span>
      }]
    }
  ]
}</code></pre>
<p>Then we’ll use pytest to check how it runs.</p>
<pre><code class="hljs language-bash">pytest -s --t=new_transformation</code></pre>
<h3 id="finishing-up">Finishing up</h3>
<h4 id="write-the-readme">Write the readme</h4>
<p>Once we’re sure our transformation is producing good results, it’s time to document it. Open up the <code>readme.md</code> document and add all the important details.</p>
<p>Make sure to include your name and contact details, along with referencing any prior work you rely on. Add an explanation of the purpose of your transformation, plus some discussion of the kind of tasks you think it will benefit, plus any limitations you’ve identified.</p>
<p>If you think it would be useful, you can check the <a href="https://github.com/GEM-benchmark/NL-Augmenter/blob/main/evaluation/README.md">evaluation documentation</a> for details of how to test your work against benchmark datasets and models, and how to add that to your documentation.</p>
<h4 id="create-your-pull-request">Create your pull request</h4>
<p>Finally, you’re ready to submit!</p>
<p>Commit all your changes to your new branch, then push them back to the origin. The easiest way to create a pull request from your commit is to <a href="https://docs.github.com/en/desktop/contributing-and-collaborating-using-github-desktop/working-with-your-remote-repository-on-github-or-github-enterprise/creating-an-issue-or-pull-request">use the Github website</a>.</p>
<a href="https://docs.github.com/en/github/getting-started-with-github/fork-a-repo">
<div style="text-align:center"><img src="https://docs.github.com/assets/images/help/desktop/windows-create-pull-request.png" alt="pull request" width="500"/></div>
</a>
<h2 id="conclusion">Conclusion</h2>
<p>And that’s it. NL-Augmenter has an active community of maintainers who will review your request and add your work to the project. In the meantime, others can try out your tranformation by cloning your fork.</p>
<p>Congratulations on contributing!</p>
</div></article></main><div class="layout_push__1J9g0"></div></div><footer class="layout_footer__127N0 utils_eggshell__Njxsh"><span class="layout_backToHome__1vZsp"><a href="/">← Home</a></span><span>If you have any questions, please join our <a href="https://groups.google.com/g/gem-benchmark" target="_blank" class="utils_accentUnderline__k083p">google group</a> for support.</span></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"taskData":{"contentHtml":"\u003cp\u003eThis tutorial will demonstrate how to add a new transformation process to the NL-Augmenter library, which researchers can then use to generate new augmented datasets.\nWe will not cover using filters in this tutorial. If you are interested in using filters, check out the tutorial \u003ca href=\"https://github.com/GEM-benchmark/GEM-benchmark.github.io/blob/main/web/data/notebooks/GEM_Hackathon_2021_filters_tutorial.ipynb\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"using-transformations\"\u003eUsing transformations\u003c/h2\u003e\n\u003cp\u003eA transformation is represented as a python class.\nTo use a transformation, instantiate an instance of the transformation class and call it via \u003ccode\u003etransformation.generate\u003c/code\u003e.\nSee the code snippet below for an example.\nNote that most transformations have unique parameters and \u003ccode\u003egenerate\u003c/code\u003e signatures.\nPlease refer to the README and code of the specific transformation you're interested in using for details.\nYou can find a full list of transformations \u003ca href=\"https://github.com/GEM-benchmark/NL-Augmenter/tree/main/transformations\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e transformations.butter_fingers_perturbation \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e ButterFingersPerturbation\ntransform = ButterFingersPerturbation(prob=\u003cspan class=\"hljs-number\"\u003e0.2\u003c/span\u003e)\ncorpus = [\u003cspan class=\"hljs-string\"\u003e'This is the first sentence.'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'This is the second sentence.'\u003c/span\u003e]\n\u003cspan class=\"hljs-comment\"\u003e# transformations return a list \u003c/span\u003e\ntransformed_corpus = [transform.generate(sentence)[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e] \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e sentence \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e corpus]\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eCurrently, transformations \u003cem\u003edo not\u003c/em\u003e support batch mode, so you will need to pass your sentences into \u003ccode\u003etransform.generate\u003c/code\u003e individually.\nAfter transforming your corpus, save your data in the preferred format (ideally \u003ccode\u003ejson\u003c/code\u003e or \u003ccode\u003ejsonlines\u003c/code\u003e).\nThen follow \u003ca href=\"https://gem-benchmark.com/tutorials/new_data_loader\"\u003ethis tutorial\u003c/a\u003e to add your dataset to GEM.\u003c/p\u003e\n\u003ch2 id=\"adding-transformations\"\u003eAdding transformations\u003c/h2\u003e\n\u003ch3 id=\"preliminaries\"\u003ePreliminaries\u003c/h3\u003e\n\u003ch4 id=\"check-for-novelty\"\u003eCheck for novelty\u003c/h4\u003e\n\u003cp\u003eFirst step, and probably the most important one, is to carefully read through the \u003ca href=\"https://github.com/GEM-benchmark/NL-Augmenter/tree/main/transformations\"\u003elist of existing transformations\u003c/a\u003e, making sure that no one has already covered the ground you’re proposing. There are dozens of existing systems and many more that are under review, so why duplicate existing work?\u003c/p\u003e\n\u003cp\u003eMake sure to check the \u003cstrong\u003etransformations\u003c/strong\u003e subdirectory in the project repo, as well as the \u003ca href=\"https://github.com/GEM-benchmark/NL-Augmenter/pulls\"\u003elist of pull requests\u003c/a\u003e.\u003c/p\u003e\n\u003ch4 id=\"check-the-documentation\"\u003eCheck the documentation\u003c/h4\u003e\n\u003cp\u003eSo, you’re certain that your contribution will be novel. Now, the next step is to go to the project repo and carefully read through the documentation. Most important for our purposes are the \u003ca href=\"https://github.com/GEM-benchmark/NL-Augmenter/blob/main/README.md\"\u003emain readme document\u003c/a\u003e, plus the readmes for the \u003ca href=\"https://github.com/GEM-benchmark/NL-Augmenter/blob/main/interfaces/README.md\"\u003e\u003cstrong\u003einterfaces\u003c/strong\u003e\u003c/a\u003e and \u003ca href=\"https://github.com/GEM-benchmark/NL-Augmenter/blob/main/evaluation/README.md\"\u003e\u003cstrong\u003eevaluation\u003c/strong\u003e\u003c/a\u003e directories.\u003c/p\u003e\n\u003cp\u003eReading these will give you a solid understanding of the rest of the steps we’re going to cover.\u003c/p\u003e\n\u003ch3 id=\"setup\"\u003eSetup\u003c/h3\u003e\n\u003ch4 id=\"fork-the-project-repo\"\u003eFork the project repo\u003c/h4\u003e\n\u003cp\u003eOnce you’re clear on the documentation, go ahead and fork the repository. New transformations should be submitted as pull requests to the main NL-Augmenter repo.\u003c/p\u003e\n\u003ca href=\"https://docs.github.com/en/github/getting-started-with-github/fork-a-repo\"\u003e\n\u003cdiv style=\"text-align:center\"\u003e\u003cimg src=\"https://docs.github.com/assets/images/help/repository/fork_button.jpg\" alt=\"fork button\" width=\"500\"/\u003e\u003c/div\u003e\n\u003c/a\u003e\n\u003cp\u003eClone to your machine, and create a new branch to work in.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003egit \u003cspan class=\"hljs-built_in\"\u003eclone\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003e$PATH_TO_YOUR_FORK\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003ecd\u003c/span\u003e NL-Augmenter\ngit checkout -b new_transformation\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"copy-an-existing-transformation-as-a-base\"\u003eCopy an existing transformation as a base\u003c/h4\u003e\n\u003cp\u003eWe’re going to start creating our own transformation by copying an existing simple example.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecd\u003c/span\u003e transformations/\ncp -r butter_fingers_perturbation new_transformation\n\u003cspan class=\"hljs-built_in\"\u003ecd\u003c/span\u003e new_transformation\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"create-your-transformation\"\u003eCreate your transformation\u003c/h3\u003e\n\u003ch4 id=\"update-the-existing-class-info\"\u003eUpdate the existing class info\u003c/h4\u003e\n\u003cp\u003eOpen the \u003ccode\u003etransformation.py\u003c/code\u003e file in your editor of choice. Make sure to rename the class to a name that describes your transformation.\u003c/p\u003e\n\u003cp\u003eThe first thing to define is \u003ca href=\"https://github.com/GEM-benchmark/NL-Augmenter/blob/main/interfaces/README.md\"\u003ewhat kind of interface\u003c/a\u003e our transformation is going to implement, which tells us what it should accept as input and return as output. As an example, we could choose to implement the QuestionAnswerOperation, which expects a question as a string, some context as a string, and answers as a list of strings, and returns a transformed version.\u003c/p\u003e\n\u003cp\u003eFor our purposes, we’ll be implementing the SentenceOperation interface, which expects only a single piece of text as input and output.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eKeyphraseInsertion\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eSentenceOperation\u003c/span\u003e):\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou’ll also need to decide which downstream tasks you think your class can be applied to: here, we’re going to choose text classification as an example.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003etasks = [TaskType.TEXT_CLASSIFICATION]\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ePick the languages this transformation can accept as input using ISO codes here. We’ll stick with English as a default.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003elanguages = [\u003cspan class=\"hljs-string\"\u003e\"en\"\u003c/span\u003e]\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe keywords list is important to fill out. This will give reviewers some idea of the purpose of your transformation, as well as the consequences of using it. You can find a full list and explanation in the \u003ca href=\"https://github.com/GEM-benchmark/NL-Augmenter/blob/main/docs/keywords.md\"\u003edocs/keywords.md\u003c/a\u003e file. I’m going to leave the existing set as they are.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003ekeywords = [\u003cspan class=\"hljs-string\"\u003e\"morphological\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"noise\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"rule-based\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"high-coverage\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"high-precision\"\u003c/span\u003e]\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"override-the-generate-method\"\u003eOverride the generate method\u003c/h4\u003e\n\u003cp\u003eNow the preliminaries are done, it’s time to create our transformation. We need to override the generate method to carry out our transformation, paying attention to the expected types of the returned values.\u003c/p\u003e\n\u003cp\u003eRemember, for SentenceOperations, the type of the output is a list of strings, so that’s what we should provide. You’ll see our sample class includes a max outputs parameter that controls the number of new outputs generated from a single input sequence. It’s recommended that you use the same format to control how many texts are returned from your transformation.\u003c/p\u003e\n\u003cp\u003eIn our example class, we’re going to insert a keyphrase between every second element in our string.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003e__init__\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eself, seed=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, max_outputs=\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, insert_every=\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, keyphrase=\u003cspan class=\"hljs-string\"\u003e\"kp_test\"\u003c/span\u003e\u003c/span\u003e):\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003esuper\u003c/span\u003e().__init__(seed, max_outputs=max_outputs)\n    self.insert_every = insert_every\n    self.keyphrase = keyphrase\n\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003egenerate\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eself, sentence: \u003cspan class=\"hljs-built_in\"\u003estr\u003c/span\u003e\u003c/span\u003e):\u003c/span\u003e\n    perturbed_texts = []\n    itertext = [sentence.split()[i:i + self.insert_every] \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e\n                \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-built_in\"\u003elen\u003c/span\u003e(sentence.split()), self.insert_every)]\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(self.max_outputs):\n        new_text = [\u003cspan class=\"hljs-string\"\u003ef\"\u003cspan class=\"hljs-subst\"\u003e{\u003cspan class=\"hljs-string\"\u003e' '\u003c/span\u003e.join(x)}\u003c/span\u003e \u003cspan class=\"hljs-subst\"\u003e{self.keyphrase}\u003c/span\u003e\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e x \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e itertext]\n        perturbed_texts.append(\u003cspan class=\"hljs-string\"\u003e' '\u003c/span\u003e.join(new_text))\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e perturbed_texts\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"add-your-requirements\"\u003eAdd your requirements\u003c/h4\u003e\n\u003cp\u003eIf you’ve added any new package requirements, you’re going to need to add them to a \u003ccode\u003erequirements.txt\u003c/code\u003e in the same directory as your transformation. This helps to keep each transformations’ imports separate.\u003c/p\u003e\n\u003cp\u003eFor example, lets add sklearn here, just in case.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003escikit-learn==1.0.1\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"test-your-solution\"\u003eTest your solution\u003c/h3\u003e\n\u003cp\u003eNow, it’s time to test your solution on some sample data to make sure it works. First, create a test.json file in the same directory as your transformation, and add at least five test cases.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-json\"\u003e{\n  \u003cspan class=\"hljs-attr\"\u003e\"type\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"new_transformation\"\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003e\"test_cases\"\u003c/span\u003e: [\n    {\n      \u003cspan class=\"hljs-attr\"\u003e\"class\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"KeyphraseInsertion\"\u003c/span\u003e,\n      \u003cspan class=\"hljs-attr\"\u003e\"inputs\"\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003e\"sentence\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"Andrew finally returned the French book to Chris that I bought last week\"\u003c/span\u003e\n      },\n      \u003cspan class=\"hljs-attr\"\u003e\"outputs\"\u003c/span\u003e: [{\n        \u003cspan class=\"hljs-attr\"\u003e\"sentence\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"Andrew finally kp_test returned the kp_test French book kp_test to Chris kp_test that I kp_test bought last kp_test week kp_test\"\u003c/span\u003e\n      }]\n    }\n  ]\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen we’ll use pytest to check how it runs.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epytest -s --t=new_transformation\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"finishing-up\"\u003eFinishing up\u003c/h3\u003e\n\u003ch4 id=\"write-the-readme\"\u003eWrite the readme\u003c/h4\u003e\n\u003cp\u003eOnce we’re sure our transformation is producing good results, it’s time to document it. Open up the \u003ccode\u003ereadme.md\u003c/code\u003e document and add all the important details.\u003c/p\u003e\n\u003cp\u003eMake sure to include your name and contact details, along with referencing any prior work you rely on. Add an explanation of the purpose of your transformation, plus some discussion of the kind of tasks you think it will benefit, plus any limitations you’ve identified.\u003c/p\u003e\n\u003cp\u003eIf you think it would be useful, you can check the \u003ca href=\"https://github.com/GEM-benchmark/NL-Augmenter/blob/main/evaluation/README.md\"\u003eevaluation documentation\u003c/a\u003e for details of how to test your work against benchmark datasets and models, and how to add that to your documentation.\u003c/p\u003e\n\u003ch4 id=\"create-your-pull-request\"\u003eCreate your pull request\u003c/h4\u003e\n\u003cp\u003eFinally, you’re ready to submit!\u003c/p\u003e\n\u003cp\u003eCommit all your changes to your new branch, then push them back to the origin. The easiest way to create a pull request from your commit is to \u003ca href=\"https://docs.github.com/en/desktop/contributing-and-collaborating-using-github-desktop/working-with-your-remote-repository-on-github-or-github-enterprise/creating-an-issue-or-pull-request\"\u003euse the Github website\u003c/a\u003e.\u003c/p\u003e\n\u003ca href=\"https://docs.github.com/en/github/getting-started-with-github/fork-a-repo\"\u003e\n\u003cdiv style=\"text-align:center\"\u003e\u003cimg src=\"https://docs.github.com/assets/images/help/desktop/windows-create-pull-request.png\" alt=\"pull request\" width=\"500\"/\u003e\u003c/div\u003e\n\u003c/a\u003e\n\u003ch2 id=\"conclusion\"\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eAnd that’s it. NL-Augmenter has an active community of maintainers who will review your request and add your work to the project. In the meantime, others can try out your tranformation by cloning your fork.\u003c/p\u003e\n\u003cp\u003eCongratulations on contributing!\u003c/p\u003e\n","title":"Using and Adding Transformation to NL-Augmenter","type":"Transformation","background":"This tutorial shows how to use and add your transformation to NL-Augmenter."}},"__N_SSG":true},"page":"/tutorials/[id]","query":{"id":"new_nl_augmenter_transformation"},"buildId":"kc-DGUyFbTVJ3ir5J_fqD","nextExport":false,"isFallback":false,"gsp":true,"head":[["meta",{"name":"viewport","content":"width=device-width"}],["meta",{"charSet":"utf-8"}],["link",{"rel":"icon","href":"/favicon.ico"}],["meta",{"name":"description","content":"Benchmark natural language generation systems with GEM."}],["meta",{"property":"og:image","content":"https://og-image.now.sh/**GEM**%20Benchmark.png?theme=light\u0026md=1\u0026fontSize=100px\u0026images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fvercel-triangle-black.svg"}],["meta",{"name":"og:title","content":"GEM"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["title",{"children":"GEM Using and Adding Transformation to NL-Augmenter"}]]}</script><script nomodule="" src="/_next/static/chunks/polyfills-e935b474c81cf901504d.js"></script><script src="/_next/static/chunks/main-47bc8f80085b54a800da.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.baa41d4dbf5d52db897c.js" async=""></script><script src="/_next/static/chunks/76fa31df43514ea5aaf6b0525de03ac0f65eec9e.4a36a385313236c59b19.js" async=""></script><script src="/_next/static/chunks/pages/_app-a9ae7a6d1de4e51a7ab6.js" async=""></script><script src="/_next/static/chunks/cb1608f2.c3a9f0eb95374ca4919a.js" async=""></script><script src="/_next/static/chunks/3a03639cec9cbb3837db9d33dd6cd155d0d21f09.13fa0eac69555f2fe80c.js" async=""></script><script src="/_next/static/chunks/pages/tutorials/%5Bid%5D-766b6427396d14dc91ae.js" async=""></script><script src="/_next/static/kc-DGUyFbTVJ3ir5J_fqD/_buildManifest.js" async=""></script><script src="/_next/static/kc-DGUyFbTVJ3ir5J_fqD/_ssgManifest.js" async=""></script></body></html>